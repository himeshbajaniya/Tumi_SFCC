{"version":3,"file":"default\\js\\reflektion.js","mappings":"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","sources":["webpack://tumi-sfcc/./integrations/link_reflektion/cartridges/int_reflektion_sfra/cartridge/client/default/js/reflektion/reflektion.js","webpack://tumi-sfcc/./storefront-reference-architecture/cartridges/app_storefront_base/cartridge/client/default/js/components/focus.js","webpack://tumi-sfcc/./storefront-reference-architecture/cartridges/app_storefront_base/cartridge/client/default/js/product/base.js","webpack://tumi-sfcc/./storefront-reference-architecture/cartridges/app_storefront_base/cartridge/client/default/js/util.js","webpack://tumi-sfcc/webpack/bootstrap","webpack://tumi-sfcc/./integrations/link_reflektion/cartridges/int_reflektion_sfra/cartridge/client/default/js/reflektion.js"],"sourcesContent":["'use strict';\r\nvar base = require('base/product/base');\r\n\r\nmodule.exports = {\r\n    reflektion: function () {\r\n        if (typeof rfkDomain !== 'undefined') {\r\n            $('body').on('product:afterAddToCart', function (data) { //eslint-disable-line\r\n                var pid = base.getPidValue($(this)); //eslint-disable-line\r\n                var name = 'pdp';\r\n                if ($(this).attr('class') === 'modal-open') { //eslint-disable-line\r\n                    name = 'qview';\r\n                }\r\n                var rfk = window.rfk = window.rfk || [];\r\n                rfk.push([\"trackEvent\", { //eslint-disable-line\r\n                    type: \"a2c\", //eslint-disable-line\r\n                    name: name,\r\n                    value: {\r\n                        products: [{\r\n                            sku: pid\r\n                        }],\r\n                        dn: rfkDomain, //eslint-disable-line\r\n                        locale: {\r\n                            lg: rfkLanguage, //eslint-disable-line\r\n                            co: rfkCountry, //eslint-disable-line\r\n                            cy: rfkCurrency //eslint-disable-line\r\n                        }\r\n                    }\r\n                }]);\r\n            });\r\n\r\n            $('body').on('cart:update', function () { //eslint-disable-line\r\n                $.ajax({ //eslint-disable-line\r\n                    url: cartGetURL, //eslint-disable-line\r\n                    method: 'GET',\r\n                    success: function (data) {\r\n                        var pids = [];\r\n                        for (var i = 0; i < data.items.length; i++) {\r\n                            pids.push({ sku: data.items[i].id });\r\n                        }\r\n                        var rfk = window.rfk = window.rfk || [];\r\n                        rfk.push([\"trackEvent\", { //eslint-disable-line\r\n                            type: \"status\", //eslint-disable-line\r\n                            name: \"cart\", //eslint-disable-line\r\n                            value: {\r\n                                products: pids,\r\n                                dn: rfkDomain, //eslint-disable-line\r\n                                locale: {\r\n                                    lg: rfkLanguage, //eslint-disable-line\r\n                                    co: rfkCountry, //eslint-disable-line\r\n                                    cy: rfkCurrency //eslint-disable-line\r\n                                }\r\n                            }\r\n                        }]);\r\n                    },\r\n                    error: function (err) {\r\n                        console.log(err);  // eslint-disable-line no-console\r\n                    }\r\n                });\r\n            });\r\n        }\r\n    }\r\n};\r\n","'use strict';\r\n\r\nmodule.exports = {\r\n    setTabNextFocus: function (focusParams) {\r\n        var KEYCODE_TAB = 9;\r\n        var isTabPressed = (focusParams.event.key === 'Tab' || focusParams.event.keyCode === KEYCODE_TAB);\r\n\r\n        if (!isTabPressed) {\r\n            return;\r\n        }\r\n\r\n        var firstFocusableEl = $(focusParams.containerSelector + ' ' + focusParams.firstElementSelector);\r\n        var lastFocusableEl = $(focusParams.containerSelector + ' ' + focusParams.lastElementSelector);\r\n\r\n        if ($(focusParams.containerSelector + ' ' + focusParams.lastElementSelector).is(':disabled')) {\r\n            lastFocusableEl = $(focusParams.containerSelector + ' ' + focusParams.nextToLastElementSelector);\r\n            if ($('.product-quickview.product-set').length > 0) {\r\n                var linkElements = $(focusParams.containerSelector + ' a#fa-link.share-icons');\r\n                lastFocusableEl = linkElements[linkElements.length - 1];\r\n            }\r\n        }\r\n\r\n        if (focusParams.event.shiftKey) /* shift + tab */ {\r\n            if ($(':focus').is(firstFocusableEl)) {\r\n                lastFocusableEl.focus();\r\n                focusParams.event.preventDefault();\r\n            }\r\n        } else /* tab */ {\r\n            if ($(':focus').is(lastFocusableEl)) { // eslint-disable-line\r\n                firstFocusableEl.focus();\r\n                focusParams.event.preventDefault();\r\n            }\r\n        }\r\n    }\r\n};\r\n","'use strict';\r\nvar focusHelper = require('../components/focus');\r\n\r\n/**\r\n * Retrieves the relevant pid value\r\n * @param {jquery} $el - DOM container for a given add to cart button\r\n * @return {string} - value to be used when adding product to cart\r\n */\r\nfunction getPidValue($el) {\r\n    var pid;\r\n\r\n    if ($('#quickViewModal').hasClass('show') && !$('.product-set').length) {\r\n        pid = $($el).closest('.modal-content').find('.product-quickview').data('pid');\r\n    } else if ($('.product-set-detail').length || $('.product-set').length) {\r\n        pid = $($el).closest('.product-detail').find('.product-id').text();\r\n    } else {\r\n        pid = $('.product-detail:not(\".bundle-item\")').data('pid');\r\n    }\r\n\r\n    return pid;\r\n}\r\n\r\n/**\r\n * Retrieve contextual quantity selector\r\n * @param {jquery} $el - DOM container for the relevant quantity\r\n * @return {jquery} - quantity selector DOM container\r\n */\r\nfunction getQuantitySelector($el) {\r\n    var quantitySelected;\r\n    if ($el && $('.set-items').length) {\r\n        quantitySelected = $($el).closest('.product-detail').find('.quantity-select');\r\n    } else if ($el && $('.product-bundle').length) {\r\n        var quantitySelectedModal = $($el).closest('.modal-footer').find('.quantity-select');\r\n        var quantitySelectedPDP = $($el).closest('.bundle-footer').find('.quantity-select');\r\n        if (quantitySelectedModal.val() === undefined) {\r\n            quantitySelected = quantitySelectedPDP;\r\n        } else {\r\n            quantitySelected = quantitySelectedModal;\r\n        }\r\n    } else {\r\n        quantitySelected = $('.quantity-select');\r\n    }\r\n    return quantitySelected;\r\n}\r\n\r\n/**\r\n * Retrieves the value associated with the Quantity pull-down menu\r\n * @param {jquery} $el - DOM container for the relevant quantity\r\n * @return {string} - value found in the quantity input\r\n */\r\nfunction getQuantitySelected($el) {\r\n    return getQuantitySelector($el).val();\r\n}\r\n\r\n/**\r\n * Process the attribute values for an attribute that has image swatches\r\n *\r\n * @param {Object} attr - Attribute\r\n * @param {string} attr.id - Attribute ID\r\n * @param {Object[]} attr.values - Array of attribute value objects\r\n * @param {string} attr.values.value - Attribute coded value\r\n * @param {string} attr.values.url - URL to de/select an attribute value of the product\r\n * @param {boolean} attr.values.isSelectable - Flag as to whether an attribute value can be\r\n *     selected.  If there is no variant that corresponds to a specific combination of attribute\r\n *     values, an attribute may be disabled in the Product Detail Page\r\n * @param {jQuery} $productContainer - DOM container for a given product\r\n * @param {Object} msgs - object containing resource messages\r\n */\r\nfunction processSwatchValues(attr, $productContainer, msgs) {\r\n    attr.values.forEach(function (attrValue) {\r\n        var $attrValue = $productContainer.find('[data-attr=\"' + attr.id + '\"] [data-attr-value=\"' +\r\n            attrValue.value + '\"]');\r\n        var $swatchButton = $attrValue.parent();\r\n\r\n        if (attrValue.selected) {\r\n            $attrValue.addClass('selected');\r\n            $attrValue.siblings('.selected-assistive-text').text(msgs.assistiveSelectedText);\r\n        } else {\r\n            $attrValue.removeClass('selected');\r\n            $attrValue.siblings('.selected-assistive-text').empty();\r\n        }\r\n\r\n        if (attrValue.url) {\r\n            $swatchButton.attr('data-url', attrValue.url);\r\n        } else {\r\n            $swatchButton.removeAttr('data-url');\r\n        }\r\n\r\n        // Disable if not selectable\r\n        $attrValue.removeClass('selectable unselectable');\r\n\r\n        $attrValue.addClass(attrValue.selectable ? 'selectable' : 'unselectable');\r\n    });\r\n}\r\n\r\n/**\r\n * Process attribute values associated with an attribute that does not have image swatches\r\n *\r\n * @param {Object} attr - Attribute\r\n * @param {string} attr.id - Attribute ID\r\n * @param {Object[]} attr.values - Array of attribute value objects\r\n * @param {string} attr.values.value - Attribute coded value\r\n * @param {string} attr.values.url - URL to de/select an attribute value of the product\r\n * @param {boolean} attr.values.isSelectable - Flag as to whether an attribute value can be\r\n *     selected.  If there is no variant that corresponds to a specific combination of attribute\r\n *     values, an attribute may be disabled in the Product Detail Page\r\n * @param {jQuery} $productContainer - DOM container for a given product\r\n */\r\nfunction processNonSwatchValues(attr, $productContainer) {\r\n    var $attr = '[data-attr=\"' + attr.id + '\"]';\r\n    var $defaultOption = $productContainer.find($attr + ' .select-' + attr.id + ' option:first');\r\n    $defaultOption.attr('value', attr.resetUrl);\r\n\r\n    attr.values.forEach(function (attrValue) {\r\n        var $attrValue = $productContainer\r\n            .find($attr + ' [data-attr-value=\"' + attrValue.value + '\"]');\r\n        $attrValue.attr('value', attrValue.url)\r\n            .removeAttr('disabled');\r\n\r\n        if (!attrValue.selectable) {\r\n            $attrValue.attr('disabled', true);\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * Routes the handling of attribute processing depending on whether the attribute has image\r\n *     swatches or not\r\n *\r\n * @param {Object} attrs - Attribute\r\n * @param {string} attr.id - Attribute ID\r\n * @param {jQuery} $productContainer - DOM element for a given product\r\n * @param {Object} msgs - object containing resource messages\r\n */\r\nfunction updateAttrs(attrs, $productContainer, msgs) {\r\n    // Currently, the only attribute type that has image swatches is Color.\r\n    var attrsWithSwatches = ['color'];\r\n\r\n    attrs.forEach(function (attr) {\r\n        if (attrsWithSwatches.indexOf(attr.id) > -1) {\r\n            processSwatchValues(attr, $productContainer, msgs);\r\n        } else {\r\n            processNonSwatchValues(attr, $productContainer);\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * Updates the availability status in the Product Detail Page\r\n *\r\n * @param {Object} response - Ajax response object after an\r\n *                            attribute value has been [de]selected\r\n * @param {jQuery} $productContainer - DOM element for a given product\r\n */\r\nfunction updateAvailability(response, $productContainer) {\r\n    var availabilityValue = '';\r\n    var availabilityMessages = response.product.availability.messages;\r\n    if (!response.product.readyToOrder) {\r\n        availabilityValue = '<li><div>' + response.resources.info_selectforstock + '</div></li>';\r\n    } else {\r\n        availabilityMessages.forEach(function (message) {\r\n            availabilityValue += '<li><div>' + message + '</div></li>';\r\n        });\r\n    }\r\n\r\n    $($productContainer).trigger('product:updateAvailability', {\r\n        product: response.product,\r\n        $productContainer: $productContainer,\r\n        message: availabilityValue,\r\n        resources: response.resources\r\n    });\r\n}\r\n\r\n/**\r\n * Generates html for product attributes section\r\n *\r\n * @param {array} attributes - list of attributes\r\n * @return {string} - Compiled HTML\r\n */\r\nfunction getAttributesHtml(attributes) {\r\n    if (!attributes) {\r\n        return '';\r\n    }\r\n\r\n    var html = '';\r\n\r\n    attributes.forEach(function (attributeGroup) {\r\n        if (attributeGroup.ID === 'mainAttributes') {\r\n            attributeGroup.attributes.forEach(function (attribute) {\r\n                html += '<div class=\"attribute-values\">' + attribute.label + ': '\r\n                    + attribute.value + '</div>';\r\n            });\r\n        }\r\n    });\r\n\r\n    return html;\r\n}\r\n\r\n/**\r\n * @typedef UpdatedOptionValue\r\n * @type Object\r\n * @property {string} id - Option value ID for look up\r\n * @property {string} url - Updated option value selection URL\r\n */\r\n\r\n/**\r\n * @typedef OptionSelectionResponse\r\n * @type Object\r\n * @property {string} priceHtml - Updated price HTML code\r\n * @property {Object} options - Updated Options\r\n * @property {string} options.id - Option ID\r\n * @property {UpdatedOptionValue[]} options.values - Option values\r\n */\r\n\r\n/**\r\n * Updates DOM using post-option selection Ajax response\r\n *\r\n * @param {OptionSelectionResponse} optionsHtml - Ajax response optionsHtml from selecting a product option\r\n * @param {jQuery} $productContainer - DOM element for current product\r\n */\r\nfunction updateOptions(optionsHtml, $productContainer) {\r\n\t// Update options\r\n    $productContainer.find('.product-options').empty().html(optionsHtml);\r\n}\r\n\r\n/**\r\n * Dynamically creates Bootstrap carousel from response containing images\r\n * @param {Object[]} imgs - Array of large product images,along with related information\r\n * @param {jQuery} $productContainer - DOM element for a given product\r\n */\r\nfunction createCarousel(imgs, $productContainer) {\r\n    var carousel = $productContainer.find('.carousel');\r\n    $(carousel).carousel('dispose');\r\n    var carouselId = $(carousel).attr('id');\r\n    $(carousel).empty().append('<ol class=\"carousel-indicators\"></ol><div class=\"carousel-inner\" role=\"listbox\"></div><a class=\"carousel-control-prev\" href=\"#' + carouselId + '\" role=\"button\" data-slide=\"prev\"><span class=\"fa icon-prev\" aria-hidden=\"true\"></span><span class=\"sr-only\">' + $(carousel).data('prev') + '</span></a><a class=\"carousel-control-next\" href=\"#' + carouselId + '\" role=\"button\" data-slide=\"next\"><span class=\"fa icon-next\" aria-hidden=\"true\"></span><span class=\"sr-only\">' + $(carousel).data('next') + '</span></a>');\r\n    for (var i = 0; i < imgs.length; i++) {\r\n        $('<div class=\"carousel-item\"><img src=\"' + imgs[i].url + '\" class=\"d-block img-fluid\" alt=\"' + imgs[i].alt + ' image number ' + parseInt(imgs[i].index, 10) + '\" title=\"' + imgs[i].title + '\" itemprop=\"image\" /></div>').appendTo($(carousel).find('.carousel-inner'));\r\n        $('<li data-target=\"#' + carouselId + '\" data-slide-to=\"' + i + '\" class=\"\"></li>').appendTo($(carousel).find('.carousel-indicators'));\r\n    }\r\n    $($(carousel).find('.carousel-item')).first().addClass('active');\r\n    $($(carousel).find('.carousel-indicators > li')).first().addClass('active');\r\n    if (imgs.length === 1) {\r\n        $($(carousel).find('.carousel-indicators, a[class^=\"carousel-control-\"]')).detach();\r\n    }\r\n    $(carousel).carousel();\r\n    $($(carousel).find('.carousel-indicators')).attr('aria-hidden', true);\r\n}\r\n\r\n/**\r\n * Parses JSON from Ajax call made whenever an attribute value is [de]selected\r\n * @param {Object} response - response from Ajax call\r\n * @param {Object} response.product - Product object\r\n * @param {string} response.product.id - Product ID\r\n * @param {Object[]} response.product.variationAttributes - Product attributes\r\n * @param {Object[]} response.product.images - Product images\r\n * @param {boolean} response.product.hasRequiredAttrsSelected - Flag as to whether all required\r\n *     attributes have been selected.  Used partially to\r\n *     determine whether the Add to Cart button can be enabled\r\n * @param {jQuery} $productContainer - DOM element for a given product.\r\n */\r\nfunction handleVariantResponse(response, $productContainer) {\r\n    var isChoiceOfBonusProducts =\r\n        $productContainer.parents('.choose-bonus-product-dialog').length > 0;\r\n    var isVaraint;\r\n    if (response.product.variationAttributes) {\r\n        updateAttrs(response.product.variationAttributes, $productContainer, response.resources);\r\n        isVaraint = response.product.productType === 'variant';\r\n        if (isChoiceOfBonusProducts && isVaraint) {\r\n            $productContainer.parent('.bonus-product-item')\r\n                .data('pid', response.product.id);\r\n\r\n            $productContainer.parent('.bonus-product-item')\r\n                .data('ready-to-order', response.product.readyToOrder);\r\n        }\r\n    }\r\n\r\n    // Update primary images\r\n    var primaryImageUrls = response.product.images.large;\r\n    //createCarousel(primaryImageUrls, $productContainer);\r\n\r\n    // Update pricing\r\n    if (!isChoiceOfBonusProducts) {\r\n        var $priceSelector = $('.prices .price', $productContainer).length\r\n            ? $('.prices .price', $productContainer)\r\n            : $('.prices .price');\r\n        $priceSelector.replaceWith(response.product.price.html);\r\n    }\r\n\r\n    // Update promotions\r\n    $productContainer.find('.promotions').empty().html(response.product.promotionsHtml);\r\n\r\n    updateAvailability(response, $productContainer);\r\n\r\n    if (isChoiceOfBonusProducts) {\r\n        var $selectButton = $productContainer.find('.select-bonus-product');\r\n        $selectButton.trigger('bonusproduct:updateSelectButton', {\r\n            product: response.product, $productContainer: $productContainer\r\n        });\r\n    } else {\r\n        // Enable \"Add to Cart\" button if all required attributes have been selected\r\n        $('button.add-to-cart, button.add-to-cart-global, button.update-cart-product-global').trigger('product:updateAddToCart', {\r\n            product: response.product, $productContainer: $productContainer\r\n        }).trigger('product:statusUpdate', response.product);\r\n    }\r\n\r\n    // Update attributes\r\n    $productContainer.find('.main-attributes').empty()\r\n        .html(getAttributesHtml(response.product.attributes));\r\n}\r\n\r\n/**\r\n * @typespec UpdatedQuantity\r\n * @type Object\r\n * @property {boolean} selected - Whether the quantity has been selected\r\n * @property {string} value - The number of products to purchase\r\n * @property {string} url - Compiled URL that specifies variation attributes, product ID, options,\r\n *     etc.\r\n */\r\n\r\n/**\r\n * Updates the quantity DOM elements post Ajax call\r\n * @param {UpdatedQuantity[]} quantities -\r\n * @param {jQuery} $productContainer - DOM container for a given product\r\n */\r\nfunction updateQuantities(quantities, $productContainer) {\r\n    if ($productContainer.parent('.bonus-product-item').length <= 0) {\r\n        var optionsHtml = quantities.map(function (quantity) {\r\n            var selected = quantity.selected ? ' selected ' : '';\r\n            return '<option value=\"' + quantity.value + '\"  data-url=\"' + quantity.url + '\"' +\r\n                selected + '>' + quantity.value + '</option>';\r\n        }).join('');\r\n        getQuantitySelector($productContainer).empty().html(optionsHtml);\r\n    }\r\n}\r\n\r\n/**\r\n * updates the product view when a product attribute is selected or deselected or when\r\n *         changing quantity\r\n * @param {string} selectedValueUrl - the Url for the selected variation value\r\n * @param {jQuery} $productContainer - DOM element for current product\r\n */\r\nfunction attributeSelect(selectedValueUrl, $productContainer) {\r\n    if (selectedValueUrl) {\r\n        $('body').trigger('product:beforeAttributeSelect',\r\n            { url: selectedValueUrl, container: $productContainer });\r\n\r\n        $.ajax({\r\n            url: selectedValueUrl,\r\n            method: 'GET',\r\n            success: function (data) {\r\n                handleVariantResponse(data, $productContainer);\r\n                updateOptions(data.product.optionsHtml, $productContainer);\r\n                updateQuantities(data.product.quantities, $productContainer);\r\n                $('body').trigger('product:afterAttributeSelect',\r\n                    { data: data, container: $productContainer });\r\n                $.spinner().stop();\r\n            },\r\n            error: function () {\r\n                $.spinner().stop();\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Retrieves url to use when adding a product to the cart\r\n *\r\n * @return {string} - The provided URL to use when adding a product to the cart\r\n */\r\nfunction getAddToCartUrl() {\r\n    return $('.add-to-cart-url').val();\r\n}\r\n\r\n/**\r\n * Parses the html for a modal window\r\n * @param {string} html - representing the body and footer of the modal window\r\n *\r\n * @return {Object} - Object with properties body and footer.\r\n */\r\nfunction parseHtml(html) {\r\n    var $html = $('<div>').append($.parseHTML(html));\r\n\r\n    var body = $html.find('.choice-of-bonus-product');\r\n    var footer = $html.find('.modal-footer').children();\r\n\r\n    return { body: body, footer: footer };\r\n}\r\n\r\n/**\r\n * Retrieves url to use when adding a product to the cart\r\n *\r\n * @param {Object} data - data object used to fill in dynamic portions of the html\r\n */\r\nfunction chooseBonusProducts(data) {\r\n    $('.modal-body').spinner().start();\r\n\r\n    if ($('#chooseBonusProductModal').length !== 0) {\r\n        $('#chooseBonusProductModal').remove();\r\n    }\r\n    var bonusUrl;\r\n    if (data.bonusChoiceRuleBased) {\r\n        bonusUrl = data.showProductsUrlRuleBased;\r\n    } else {\r\n        bonusUrl = data.showProductsUrlListBased;\r\n    }\r\n\r\n    var htmlString = '<!-- Modal -->'\r\n        + '<div class=\"modal fade\" id=\"chooseBonusProductModal\" tabindex=\"-1\" role=\"dialog\">'\r\n        + '<span class=\"enter-message sr-only\" ></span>'\r\n        + '<div class=\"modal-dialog choose-bonus-product-dialog\" '\r\n        + 'data-total-qty=\"' + data.maxBonusItems + '\"'\r\n        + 'data-UUID=\"' + data.uuid + '\"'\r\n        + 'data-pliUUID=\"' + data.pliUUID + '\"'\r\n        + 'data-addToCartUrl=\"' + data.addToCartUrl + '\"'\r\n        + 'data-pageStart=\"0\"'\r\n        + 'data-pageSize=\"' + data.pageSize + '\"'\r\n        + 'data-moreURL=\"' + data.showProductsUrlRuleBased + '\"'\r\n        + 'data-bonusChoiceRuleBased=\"' + data.bonusChoiceRuleBased + '\">'\r\n        + '<!-- Modal content-->'\r\n        + '<div class=\"modal-content\">'\r\n        + '<div class=\"modal-header\">'\r\n        + '    <span class=\"\">' + data.labels.selectprods + '</span>'\r\n        + '    <button type=\"button\" class=\"close pull-right\" data-dismiss=\"modal\">'\r\n        + '        <span aria-hidden=\"true\">&times;</span>'\r\n        + '        <span class=\"sr-only\"> </span>'\r\n        + '    </button>'\r\n        + '</div>'\r\n        + '<div class=\"modal-body\"></div>'\r\n        + '<div class=\"modal-footer\"></div>'\r\n        + '</div>'\r\n        + '</div>'\r\n        + '</div>';\r\n    $('body').append(htmlString);\r\n    $('.modal-body').spinner().start();\r\n\r\n    $.ajax({\r\n        url: bonusUrl,\r\n        method: 'GET',\r\n        dataType: 'json',\r\n        success: function (response) {\r\n            var parsedHtml = parseHtml(response.renderedTemplate);\r\n            $('#chooseBonusProductModal .modal-body').empty();\r\n            $('#chooseBonusProductModal .enter-message').text(response.enterDialogMessage);\r\n            $('#chooseBonusProductModal .modal-header .close .sr-only').text(response.closeButtonText);\r\n            $('#chooseBonusProductModal .modal-body').html(parsedHtml.body);\r\n            $('#chooseBonusProductModal .modal-footer').html(parsedHtml.footer);\r\n            $('#chooseBonusProductModal').modal('show');\r\n            $.spinner().stop();\r\n        },\r\n        error: function () {\r\n            $.spinner().stop();\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * Updates the Mini-Cart quantity value after the customer has pressed the \"Add to Cart\" button\r\n * @param {string} response - ajax response from clicking the add to cart button\r\n */\r\nfunction handlePostCartAdd(response) {\r\n    $('.minicart').trigger('count:update', response);\r\n    var messageType = response.error ? 'alert-danger' : 'alert-success';\r\n    // show add to cart toast\r\n    if (response.newBonusDiscountLineItem\r\n        && Object.keys(response.newBonusDiscountLineItem).length !== 0) {\r\n        chooseBonusProducts(response.newBonusDiscountLineItem);\r\n    } else {\r\n        if ($('.add-to-cart-messages').length === 0) {\r\n            $('body').append(\r\n                '<div class=\"add-to-cart-messages\"></div>'\r\n            );\r\n        }\r\n\r\n        $('.add-to-cart-messages').append(\r\n            '<div class=\"alert ' + messageType + ' add-to-basket-alert text-center\" role=\"alert\">'\r\n            + response.message\r\n            + '</div>'\r\n        );\r\n\r\n        setTimeout(function () {\r\n            $('.add-to-basket-alert').remove();\r\n        }, 5000);\r\n    }\r\n}\r\n\r\n/**\r\n * Retrieves the bundle product item ID's for the Controller to replace bundle master product\r\n * items with their selected variants\r\n *\r\n * @return {string[]} - List of selected bundle product item ID's\r\n */\r\nfunction getChildProducts() {\r\n    var childProducts = [];\r\n    $('.bundle-item').each(function () {\r\n        childProducts.push({\r\n            pid: $(this).find('.product-id').text(),\r\n            quantity: parseInt($(this).find('label.quantity').data('quantity'), 10)\r\n        });\r\n    });\r\n\r\n    return childProducts.length ? JSON.stringify(childProducts) : [];\r\n}\r\n\r\n/**\r\n * Retrieve product options\r\n *\r\n * @param {jQuery} $productContainer - DOM element for current product\r\n * @return {string} - Product options and their selected values\r\n */\r\nfunction getOptions($productContainer) {\r\n    var options = $productContainer\r\n        .find('.product-option')\r\n        .map(function () {\r\n            var $elOption = $(this).find('.options-select');\r\n            var urlValue = $elOption.val();\r\n            var selectedValueId = $elOption.find('option[value=\"' + urlValue + '\"]')\r\n                .data('value-id');\r\n            return {\r\n                optionId: $(this).data('option-id'),\r\n                selectedValueId: selectedValueId\r\n            };\r\n        }).toArray();\r\n\r\n    return JSON.stringify(options);\r\n}\r\n\r\n/**\r\n * Makes a call to the server to report the event of adding an item to the cart\r\n *\r\n * @param {string | boolean} url - a string representing the end point to hit so that the event can be recorded, or false\r\n */\r\nfunction miniCartReportingUrl(url) {\r\n    if (url) {\r\n        $.ajax({\r\n            url: url,\r\n            method: 'GET',\r\n            success: function () {\r\n                // reporting urls hit on the server\r\n            },\r\n            error: function () {\r\n                // no reporting urls hit on the server\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nmodule.exports = {\r\n    attributeSelect: attributeSelect,\r\n    methods: {\r\n        editBonusProducts: function (data) {\r\n            chooseBonusProducts(data);\r\n        }\r\n    },\r\n\r\n    focusChooseBonusProductModal: function () {\r\n        $('body').on('shown.bs.modal', '#chooseBonusProductModal', function () {\r\n            $('#chooseBonusProductModal').siblings().attr('aria-hidden', 'true');\r\n            $('#chooseBonusProductModal .close').focus();\r\n        });\r\n    },\r\n\r\n    onClosingChooseBonusProductModal: function () {\r\n        $('body').on('hidden.bs.modal', '#chooseBonusProductModal', function () {\r\n            $('#chooseBonusProductModal').siblings().attr('aria-hidden', 'false');\r\n        });\r\n    },\r\n\r\n    trapChooseBonusProductModalFocus: function () {\r\n        $('body').on('keydown', '#chooseBonusProductModal', function (e) {\r\n            var focusParams = {\r\n                event: e,\r\n                containerSelector: '#chooseBonusProductModal',\r\n                firstElementSelector: '.close',\r\n                lastElementSelector: '.add-bonus-products'\r\n            };\r\n            focusHelper.setTabNextFocus(focusParams);\r\n        });\r\n    },\r\n\r\n    colorAttribute: function () {\r\n        $(document).on('click', '[data-attr=\"color\"] button', function (e) {\r\n            e.preventDefault();\r\n\r\n            if ($(this).attr('disabled')) {\r\n                return;\r\n            }\r\n            var $productContainer = $(this).closest('.set-item');\r\n            if (!$productContainer.length) {\r\n                $productContainer = $(this).closest('.product-detail');\r\n            }\r\n\r\n            attributeSelect($(this).attr('data-url'), $productContainer);\r\n        });\r\n    },\r\n\r\n    selectAttribute: function () {\r\n        $(document).on('change', 'select[class*=\"select-\"], .options-select', function (e) {\r\n            e.preventDefault();\r\n\r\n            var $productContainer = $(this).closest('.set-item');\r\n            if (!$productContainer.length) {\r\n                $productContainer = $(this).closest('.product-detail');\r\n            }\r\n            attributeSelect(e.currentTarget.value, $productContainer);\r\n        });\r\n    },\r\n\r\n    availability: function () {\r\n        $(document).on('change', '.quantity-select', function (e) {\r\n            e.preventDefault();\r\n\r\n            var $productContainer = $(this).closest('.product-detail');\r\n            if (!$productContainer.length) {\r\n                $productContainer = $(this).closest('.modal-content').find('.product-quickview');\r\n            }\r\n\r\n            if ($('.bundle-items', $productContainer).length === 0) {\r\n                attributeSelect($(e.currentTarget).find('option:selected').data('url'),\r\n                    $productContainer);\r\n            }\r\n        });\r\n    },\r\n\r\n    addToCart: function () {\r\n        $(document).on('click', 'button.add-to-cart, button.add-to-cart-global', function () {\r\n            var addToCartUrl;\r\n            var pid;\r\n            var pidsObj;\r\n            var setPids;\r\n\r\n            $('body').trigger('product:beforeAddToCart', this);\r\n\r\n            if ($('.set-items').length && $(this).hasClass('add-to-cart-global')) {\r\n                setPids = [];\r\n\r\n                $('.product-detail').each(function () {\r\n                    if (!$(this).hasClass('product-set-detail')) {\r\n                        setPids.push({\r\n                            pid: $(this).find('.product-id').text(),\r\n                            qty: $(this).find('.quantity-select').val(),\r\n                            options: getOptions($(this))\r\n                        });\r\n                    }\r\n                });\r\n                pidsObj = JSON.stringify(setPids);\r\n            }\r\n\r\n            pid = getPidValue($(this));\r\n\r\n            var $productContainer = $(this).closest('.product-detail');\r\n            if (!$productContainer.length) {\r\n                $productContainer = $(this).closest('.quick-view-dialog').find('.product-detail');\r\n            }\r\n\r\n            addToCartUrl = getAddToCartUrl();\r\n\r\n            var form = {\r\n                pid: pid,\r\n                pidsObj: pidsObj,\r\n                childProducts: getChildProducts(),\r\n                quantity: getQuantitySelected($(this))\r\n            };\r\n\r\n            if (!$('.bundle-item').length) {\r\n                form.options = getOptions($productContainer);\r\n            }\r\n\r\n            $(this).trigger('updateAddToCartFormData', form);\r\n            if (addToCartUrl) {\r\n                $.ajax({\r\n                    url: addToCartUrl,\r\n                    method: 'POST',\r\n                    data: form,\r\n                    success: function (data) {\r\n                        handlePostCartAdd(data);\r\n                        $('body').trigger('product:afterAddToCart', data);\r\n                        $.spinner().stop();\r\n                        miniCartReportingUrl(data.reportingURL);\r\n                    },\r\n                    error: function () {\r\n                        $.spinner().stop();\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    },\r\n    selectBonusProduct: function () {\r\n        $(document).on('click', '.select-bonus-product', function () {\r\n            var $choiceOfBonusProduct = $(this).parents('.choice-of-bonus-product');\r\n            var pid = $(this).data('pid');\r\n            var maxPids = $('.choose-bonus-product-dialog').data('total-qty');\r\n            var submittedQty = parseInt($choiceOfBonusProduct.find('.bonus-quantity-select').val(), 10);\r\n            var totalQty = 0;\r\n            $.each($('#chooseBonusProductModal .selected-bonus-products .selected-pid'), function () {\r\n                totalQty += $(this).data('qty');\r\n            });\r\n            totalQty += submittedQty;\r\n            var optionID = $choiceOfBonusProduct.find('.product-option').data('option-id');\r\n            var valueId = $choiceOfBonusProduct.find('.options-select option:selected').data('valueId');\r\n            if (totalQty <= maxPids) {\r\n                var selectedBonusProductHtml = ''\r\n                + '<div class=\"selected-pid row\" '\r\n                + 'data-pid=\"' + pid + '\"'\r\n                + 'data-qty=\"' + submittedQty + '\"'\r\n                + 'data-optionID=\"' + (optionID || '') + '\"'\r\n                + 'data-option-selected-value=\"' + (valueId || '') + '\"'\r\n                + '>'\r\n                + '<div class=\"col-sm-11 col-9 bonus-product-name\" >'\r\n                + $choiceOfBonusProduct.find('.product-name').html()\r\n                + '</div>'\r\n                + '<div class=\"col-1\"><i class=\"fa fa-times\" aria-hidden=\"true\"></i></div>'\r\n                + '</div>'\r\n                ;\r\n                $('#chooseBonusProductModal .selected-bonus-products').append(selectedBonusProductHtml);\r\n                $('.pre-cart-products').html(totalQty);\r\n                $('.selected-bonus-products .bonus-summary').removeClass('alert-danger');\r\n            } else {\r\n                $('.selected-bonus-products .bonus-summary').addClass('alert-danger');\r\n            }\r\n        });\r\n    },\r\n    removeBonusProduct: function () {\r\n        $(document).on('click', '.selected-pid', function () {\r\n            $(this).remove();\r\n            var $selected = $('#chooseBonusProductModal .selected-bonus-products .selected-pid');\r\n            var count = 0;\r\n            if ($selected.length) {\r\n                $selected.each(function () {\r\n                    count += parseInt($(this).data('qty'), 10);\r\n                });\r\n            }\r\n\r\n            $('.pre-cart-products').html(count);\r\n            $('.selected-bonus-products .bonus-summary').removeClass('alert-danger');\r\n        });\r\n    },\r\n    enableBonusProductSelection: function () {\r\n        $('body').on('bonusproduct:updateSelectButton', function (e, response) {\r\n            $('button.select-bonus-product', response.$productContainer).attr('disabled',\r\n                (!response.product.readyToOrder || !response.product.available));\r\n            var pid = response.product.id;\r\n            $('button.select-bonus-product', response.$productContainer).data('pid', pid);\r\n        });\r\n    },\r\n    showMoreBonusProducts: function () {\r\n        $(document).on('click', '.show-more-bonus-products', function () {\r\n            var url = $(this).data('url');\r\n            $('.modal-content').spinner().start();\r\n            $.ajax({\r\n                url: url,\r\n                method: 'GET',\r\n                success: function (html) {\r\n                    var parsedHtml = parseHtml(html);\r\n                    $('.modal-body').append(parsedHtml.body);\r\n                    $('.show-more-bonus-products:first').remove();\r\n                    $('.modal-content').spinner().stop();\r\n                },\r\n                error: function () {\r\n                    $('.modal-content').spinner().stop();\r\n                }\r\n            });\r\n        });\r\n    },\r\n    addBonusProductsToCart: function () {\r\n        $(document).on('click', '.add-bonus-products', function () {\r\n            var $readyToOrderBonusProducts = $('.choose-bonus-product-dialog .selected-pid');\r\n            var queryString = '?pids=';\r\n            var url = $('.choose-bonus-product-dialog').data('addtocarturl');\r\n            var pidsObject = {\r\n                bonusProducts: []\r\n            };\r\n\r\n            $.each($readyToOrderBonusProducts, function () {\r\n                var qtyOption =\r\n                    parseInt($(this)\r\n                        .data('qty'), 10);\r\n\r\n                var option = null;\r\n                if (qtyOption > 0) {\r\n                    if ($(this).data('optionid') && $(this).data('option-selected-value')) {\r\n                        option = {};\r\n                        option.optionId = $(this).data('optionid');\r\n                        option.productId = $(this).data('pid');\r\n                        option.selectedValueId = $(this).data('option-selected-value');\r\n                    }\r\n                    pidsObject.bonusProducts.push({\r\n                        pid: $(this).data('pid'),\r\n                        qty: qtyOption,\r\n                        options: [option]\r\n                    });\r\n                    pidsObject.totalQty = parseInt($('.pre-cart-products').html(), 10);\r\n                }\r\n            });\r\n            queryString += JSON.stringify(pidsObject);\r\n            queryString = queryString + '&uuid=' + $('.choose-bonus-product-dialog').data('uuid');\r\n            queryString = queryString + '&pliuuid=' + $('.choose-bonus-product-dialog').data('pliuuid');\r\n            $.spinner().start();\r\n            $.ajax({\r\n                url: url + queryString,\r\n                method: 'POST',\r\n                success: function (data) {\r\n                    $.spinner().stop();\r\n                    if (data.error) {\r\n                        $('#chooseBonusProductModal').modal('hide');\r\n                        if ($('.add-to-cart-messages').length === 0) {\r\n                            $('body').append('<div class=\"add-to-cart-messages\"></div>');\r\n                        }\r\n                        $('.add-to-cart-messages').append(\r\n                            '<div class=\"alert alert-danger add-to-basket-alert text-center\"'\r\n                            + ' role=\"alert\">'\r\n                            + data.errorMessage + '</div>'\r\n                        );\r\n                        setTimeout(function () {\r\n                            $('.add-to-basket-alert').remove();\r\n                        }, 3000);\r\n                    } else {\r\n                        $('.configure-bonus-product-attributes').html(data);\r\n                        $('.bonus-products-step2').removeClass('hidden-xl-down');\r\n                        $('#chooseBonusProductModal').modal('hide');\r\n\r\n                        if ($('.add-to-cart-messages').length === 0) {\r\n                            $('body').append('<div class=\"add-to-cart-messages\"></div>');\r\n                        }\r\n                        $('.minicart-quantity').html(data.totalQty);\r\n                        $('.add-to-cart-messages').append(\r\n                            '<div class=\"alert alert-success add-to-basket-alert text-center\"'\r\n                            + ' role=\"alert\">'\r\n                            + data.msgSuccess + '</div>'\r\n                        );\r\n                        setTimeout(function () {\r\n                            $('.add-to-basket-alert').remove();\r\n                            if ($('.cart-page').length) {\r\n                                location.reload();\r\n                            }\r\n                        }, 1500);\r\n                    }\r\n                },\r\n                error: function () {\r\n                    $.spinner().stop();\r\n                }\r\n            });\r\n        });\r\n    },\r\n\r\n    getPidValue: getPidValue,\r\n    getQuantitySelected: getQuantitySelected,\r\n    miniCartReportingUrl: miniCartReportingUrl\r\n};\r\n","'use strict';\r\n\r\nmodule.exports = function (include) {\r\n    if (typeof include === 'function') {\r\n        include();\r\n    } else if (typeof include === 'object') {\r\n        Object.keys(include).forEach(function (key) {\r\n            if (typeof include[key] === 'function') {\r\n                include[key]();\r\n            }\r\n        });\r\n    }\r\n};\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","'use strict';\r\n\r\nvar processInclude = require('base/util');\r\n\r\n$(document).ready(function () { //eslint-disable-line\r\n    processInclude(require('./reflektion/reflektion'));\r\n});\r\n"],"names":["base","require","module","exports","reflektion","rfkDomain","$","on","data","pid","getPidValue","name","attr","rfk","window","push","type","value","products","sku","dn","locale","lg","rfkLanguage","co","rfkCountry","cy","rfkCurrency","ajax","url","cartGetURL","method","success","pids","i","items","length","id","error","err","console","log","setTabNextFocus","focusParams","KEYCODE_TAB","isTabPressed","event","key","keyCode","firstFocusableEl","containerSelector","firstElementSelector","lastFocusableEl","lastElementSelector","is","nextToLastElementSelector","linkElements","shiftKey","focus","preventDefault","focusHelper","$el","hasClass","closest","find","text","getQuantitySelector","quantitySelected","quantitySelectedModal","quantitySelectedPDP","val","undefined","getQuantitySelected","processSwatchValues","$productContainer","msgs","values","forEach","attrValue","$attrValue","$swatchButton","parent","selected","addClass","siblings","assistiveSelectedText","removeClass","empty","removeAttr","selectable","processNonSwatchValues","$attr","$defaultOption","resetUrl","updateAttrs","attrs","attrsWithSwatches","indexOf","updateAvailability","response","availabilityValue","availabilityMessages","product","availability","messages","readyToOrder","resources","info_selectforstock","message","trigger","getAttributesHtml","attributes","html","attributeGroup","ID","attribute","label","updateOptions","optionsHtml","createCarousel","imgs","carousel","carouselId","append","alt","parseInt","index","title","appendTo","first","detach","handleVariantResponse","isChoiceOfBonusProducts","parents","isVaraint","variationAttributes","productType","primaryImageUrls","images","large","$priceSelector","replaceWith","price","promotionsHtml","$selectButton","updateQuantities","quantities","map","quantity","join","attributeSelect","selectedValueUrl","container","spinner","stop","getAddToCartUrl","parseHtml","$html","parseHTML","body","footer","children","chooseBonusProducts","start","remove","bonusUrl","bonusChoiceRuleBased","showProductsUrlRuleBased","showProductsUrlListBased","htmlString","maxBonusItems","uuid","pliUUID","addToCartUrl","pageSize","labels","selectprods","dataType","parsedHtml","renderedTemplate","enterDialogMessage","closeButtonText","modal","handlePostCartAdd","messageType","newBonusDiscountLineItem","Object","keys","setTimeout","getChildProducts","childProducts","each","JSON","stringify","getOptions","options","$elOption","urlValue","selectedValueId","optionId","toArray","miniCartReportingUrl","methods","editBonusProducts","focusChooseBonusProductModal","onClosingChooseBonusProductModal","trapChooseBonusProductModalFocus","e","colorAttribute","document","selectAttribute","currentTarget","addToCart","pidsObj","setPids","qty","form","reportingURL","selectBonusProduct","$choiceOfBonusProduct","maxPids","submittedQty","totalQty","optionID","valueId","selectedBonusProductHtml","removeBonusProduct","$selected","count","enableBonusProductSelection","available","showMoreBonusProducts","addBonusProductsToCart","$readyToOrderBonusProducts","queryString","pidsObject","bonusProducts","qtyOption","option","productId","errorMessage","msgSuccess","location","reload","include","processInclude","ready"],"sourceRoot":""}